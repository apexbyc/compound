# 高频订单因子计算算法对比与实现

## 📋 项目概述

本项目基于国信证券研究报告，实现了四种不同的高频订单因子计算方法。包含完整的因子体系：6个基本子因子、4个合成因子、16种订单类型因子及精选复合因子。

## 🏗️ 算法对比总览

| 文件                       | 算法类型   | n值计算   | n值保存   | 输出文件数 |
| ------------------------ | ------ | ------ | ------ | ----- |
| **normal.py**            | 固定分位数法 | ❌ 不涉及  | ❌ 不涉及  | 1个    |
| **closetotheorginal.py** | 优化匹配法  | ✅ 优化计算 | ✅ 详细保存 | 4个    |
| **closeto10%.py**        | 公式反推法  | ✅ 公式计算 | ✅ 简洁保存 | 4个    |

## 🔧 各算法详细说明

### 一、normal.py - 原版报告算法

#### 算法原理

固定使用90%分位数作为大单和漫长订单的划分阈值，完全按照原报告方法实现。

#### 关键特性

- 划分比例严格固定为10%
- 不涉及n值概念
- 计算简单，可复现性强

#### 输出文件

- `all_factors_complete.csv` - 完整因子结果

#### 

---

### 二、closeto10%.py - 求的是使得划分后占比结果为10%时的n，划分依据是均值+n*标准差

#### 算法原理

基于所有股票数据直接计算n值，收集所有股票的买单和卖单数据并计算对应的划分n值。

#### 结果

- n_big_buy = 0.13981784744312523
- n_big_sell = 0.12678582163291602
- n_long_buy = -0.028981438671264445
- n_long_sell = -0.02765870234540911

#### 输出文件

- ` n_values_0251203_222420.csv`  - n值文件（含买卖单分别的n值）

- ` core_factors_0251203_222420.csv`  - 核心因子

- ` all_factors_0251203_222420.csv`  - 完整因子
  
  ` order_types_0251203_222420.csv`  - 16种订单类型因子

#### 

---

### 三、closetotheorginal.py - 求的是使得划分后结果与原版划分最接近的n，划分依据是均值+n*标准差

#### 算法原理

- 1. 为每只股票计算最优n值（最大化Jaccard相似度）
- 2. 收集所有股票的n值
- 3. 取中位数作为全局n值
- 4. 使用全局n值计算所有因子于所有股票数据直接计算n值，收集所有股票的买单和卖单数据并计算对应的划分n值。

#### 结果

- global_n_big = 0.29837403446049265
- global_n_long = -0.03584473472127023
- 划分相似度：
  - 大单划分：97.67%
  - 漫长订单划分：94.81%

#### 输出文件

- `optimal_n_values_20251203_223953.csv`  - n值文件（含买卖单分别的n值）

- `core_factors_optimal_n_20251203_223953.csv`  - 核心因子

- `all_factors_optimal_n_20251203_223953.csv`  - 完整因子`order_types_optimal_n_20251203_223953.csv`  - 16种订单类型因子

#### 

---
